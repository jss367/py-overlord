from typing import Type

from dominion.cards.base_card import Card
from dominion.cards.base_set import (
    Chapel,
    CouncilRoom,
    Festival,
    Gardens,
    Laboratory,
    Library,
    Market,
    Mine,
    Moat,
    Smithy,
    Village,
    Witch,
    Workshop,
)
from dominion.cards.expansions import (
    Fairgrounds,
    FarmingVillage,
    FortuneTeller,
    Archive,
    Advisor,
    Beggar,
    Baker,
    Butcher,
    BustlingVillage,
    CandlestickMaker,
    Hamlet,
    Capital,
    Castle,
    Catapult,
    Harvest,
    Charm,
    ChariotRace,
    Doctor,
    Crown,
    Collection,
    HornOfPlenty,
    Emporium,
    Encampment,
    Engineer,
    Herald,
    HorseTraders,
    HuntingParty,
    Jester,
    FarmersMarket,
    Forager,
    Forum,
    Fortune,
    Menagerie,
    Remake,
    Gladiator,
    Groundskeeper,
    Journeyman,
    Legionary,
    Masterpiece,
    MerchantGuild,
    Miser,
    Modify,
    Overlord,
    Plaza,
    Patrician,
    Plunder,
    Tournament,
    Rats,
    Rebuild,
    Rocks,
    RoyalBlacksmith,
    Soothsayer,
    Sacrifice,
    Settlers,
    Stonemason,
    Skulk,
    YoungWitch,
    SnowyVillage,
    Taxman,
    Temple,
    Villa,
    WildHunt,
    Crypt,
    Hovel,
    Necropolis,
    OvergrownEstate,
    Bank,
    Bishop,
    City,
    CityQuarter,
    Contraband,
    CountingHouse,
    Expand,
    Forge,
    Goons,
    GrandMarket,
    Hoard,
    KingsCourt,
    Loan,
    Mint,
    Monument,
    Mountebank,
    Peddler,
    Quarry,
    Rabble,
    RoyalSeal,
    Talisman,
    TradeRoute,
    Vault,
    Venture,
    Watchtower,
    WorkersVillage,
    Platinum,
    Colony,
    Amphora,
    Doubloons,
    EndlessChalice,
    Figurehead,
    Hammer,
    Insignia,
    Jewels,
    Orb,
    PrizeGoat,
    PuzzleBox,
    Sextant,
    Shield,
    SpellScroll,
    Staff,
    Sword,
    LOOT_CARD_NAMES,
)
from dominion.cards.hinterlands import (
    Berserker,
    BorderVillage,
    Cache,
    Cartographer,
    Cauldron,
    Crossroads,
    Develop,
    Duchess,
    Embassy,
    Farmland,
    FoolsGold,
    GuardDog,
    Haggler,
    Highway,
    IllGottenGains,
    Inn,
    JackOfAllTrades,
    Mandarin,
    Margrave,
    Mill,
    NobleBrigand,
    NomadCamp,
    Nomads,
    Oasis,
    Oracle,
    Scheme,
    SilkRoad,
    Souk,
    SpiceMerchant,
    Stables,
    Trader,
    Trail,
    Tunnel,
    Weaver,
    Wheelwright,
    WitchsHut,
)
from dominion.cards.renaissance import ActingTroupe, Inventor
from dominion.cards.allies import Taskmaster, WealthyVillage
from dominion.cards.intrigue import (
    Torturer,
    Patrol,
    Bridge,
    Nobles,
    WishingWell,
    Conspirator,
    Ironworks,
    Pawn,
)
from dominion.cards.plunder import Barbarian, FirstMate, Flagship, Highwayman, Trickster
from dominion.cards.dark_ages import Armory, Count, Ironmonger, Marauder, PoorHouse, Spoils, Ruins
from dominion.cards.seaside import Bazaar, Lookout, NativeVillage, TradingPost, Wharf
from dominion.cards.adventures import Artificer, Giant, Messenger
from dominion.cards.nocturne import TragicHero
from dominion.cards.menagerie import Destrier, Horse, Mastermind, Paddock

from dominion.cards.treasures import Copper, Gold, Silver
from dominion.cards.victory import Curse, Duchy, Estate, Province

# Updated registry of all card types
CARD_TYPES: dict[str, Type[Card]] = {
    # Treasure cards
    "Copper": Copper,
    "Silver": Silver,
    "Gold": Gold,
    # Victory cards
    "Estate": Estate,
    "Duchy": Duchy,
    "Province": Province,
    "Curse": Curse,
    "Gardens": Gardens,
    # Action cards
    "Village": Village,
    "Smithy": Smithy,
    "Market": Market,
    "Festival": Festival,
    "Laboratory": Laboratory,
    "Mine": Mine,
    "Witch": Witch,
    "Moat": Moat,
    "Workshop": Workshop,
    "Chapel": Chapel,
    "Council Room": CouncilRoom,
    "Council room": CouncilRoom,
    "Library": Library,
    # Expansion cards
    "Advisor": Advisor,
    "Baker": Baker,
    "Butcher": Butcher,
    "Candlestick Maker": CandlestickMaker,
    "Candlestick maker": CandlestickMaker,
    "Archive": Archive,
    "Fairgrounds": Fairgrounds,
    "Farming Village": FarmingVillage,
    "Fortune Teller": FortuneTeller,
    "Bustling Village": BustlingVillage,
    "Hamlet": Hamlet,
    "Capital": Capital,
    "Castle": Castle,
    "Catapult": Catapult,
    "Harvest": Harvest,
    "Charm": Charm,
    "Chariot Race": ChariotRace,
    "Patrician": Patrician,
    "Emporium": Emporium,
    "Horn of Plenty": HornOfPlenty,
    "Forager": Forager,
    "Horse Traders": HorseTraders,
    "Hunting Party": HuntingParty,
    "Jester": Jester,
    "Snowy Village": SnowyVillage,
    "Menagerie": Menagerie,
    "Miser": Miser,
    "Rats": Rats,
    "Skulk": Skulk,
    "Collection": Collection,
    "Doctor": Doctor,
    "Beggar": Beggar,
    "Poor House": PoorHouse,
    "Poor house": PoorHouse,
    "Modify": Modify,
    "Remake": Remake,
    "Rebuild": Rebuild,
    "Count": Count,
    "Armory": Armory,
    "Tournament": Tournament,
    "Crypt": Crypt,
    "Hovel": Hovel,
    "Necropolis": Necropolis,
    "Overgrown Estate": OvergrownEstate,
    "Young Witch": YoungWitch,
    "Crown": Crown,
    "Herald": Herald,
    "Encampment": Encampment,
    "Engineer": Engineer,
    "Farmers' Market": FarmersMarket,
    "Forum": Forum,
    "Fortune": Fortune,
    "Gladiator": Gladiator,
    "Bank": Bank,
    "Bishop": Bishop,
    "City": City,
    "City Quarter": CityQuarter,
    "City quarter": CityQuarter,
    "Contraband": Contraband,
    "Counting House": CountingHouse,
    "Expand": Expand,
    "Forge": Forge,
    "Goons": Goons,
    "Grand Market": GrandMarket,
    "Hoard": Hoard,
    "King's Court": KingsCourt,
    "Loan": Loan,
    "Mint": Mint,
    "Monument": Monument,
    "Mountebank": Mountebank,
    "Overlord": Overlord,
    "Peddler": Peddler,
    "Quarry": Quarry,
    "Rabble": Rabble,
    "Rocks": Rocks,
    "Royal Seal": RoyalSeal,
    "Royal Blacksmith": RoyalBlacksmith,
    "Sacrifice": Sacrifice,
    "Settlers": Settlers,
    "Talisman": Talisman,
    "Temple": Temple,
    "Trade Route": TradeRoute,
    "Vault": Vault,
    "Venture": Venture,
    "Watchtower": Watchtower,
    "Workers' Village": WorkersVillage,
    "Villa": Villa,
    "Wild Hunt": WildHunt,
    "Legionary": Legionary,
    "Groundskeeper": Groundskeeper,
    "Plunder": Plunder,
    "Journeyman": Journeyman,
    "Masterpiece": Masterpiece,
    "Merchant Guild": MerchantGuild,
    "Merchant guild": MerchantGuild,
    "Plaza": Plaza,
    "Platinum": Platinum,
    "Colony": Colony,
    "Amphora": Amphora,
    "Doubloons": Doubloons,
    "Endless Chalice": EndlessChalice,
    "Figurehead": Figurehead,
    "Hammer": Hammer,
    "Insignia": Insignia,
    "Jewels": Jewels,
    "Orb": Orb,
    "Prize Goat": PrizeGoat,
    "Puzzle Box": PuzzleBox,
    "Sextant": Sextant,
    "Shield": Shield,
    "Spell Scroll": SpellScroll,
    "Staff": Staff,
    "Sword": Sword,
    "Soothsayer": Soothsayer,
    "Stonemason": Stonemason,
    "Taxman": Taxman,
    "Berserker": Berserker,
    "Border Village": BorderVillage,
    "Cache": Cache,
    "Cartographer": Cartographer,
    "Cauldron": Cauldron,
    "Crossroads": Crossroads,
    "Develop": Develop,
    "Duchess": Duchess,
    "Embassy": Embassy,
    "Farmland": Farmland,
    "Fool's Gold": FoolsGold,
    "Guard Dog": GuardDog,
    "Haggler": Haggler,
    "Highway": Highway,
    "Ill-Gotten Gains": IllGottenGains,
    "Inn": Inn,
    "Jack of All Trades": JackOfAllTrades,
    "Mandarin": Mandarin,
    "Margrave": Margrave,
    "Mill": Mill,
    "Noble Brigand": NobleBrigand,
    "Nomad Camp": NomadCamp,
    "Nomads": Nomads,
    "Oasis": Oasis,
    "Oracle": Oracle,
    "Scheme": Scheme,
    "Silk Road": SilkRoad,
    "Souk": Souk,
    "Spice Merchant": SpiceMerchant,
    "Stables": Stables,
    "Trader": Trader,
    "Trail": Trail,
    "Tunnel": Tunnel,
    "Weaver": Weaver,
    "Wheelwright": Wheelwright,
    "Witch's Hut": WitchsHut,
    "Acting Troupe": ActingTroupe,
    "Inventor": Inventor,
    "Taskmaster": Taskmaster,
    "Wealthy Village": WealthyVillage,
    "Wealthy village": WealthyVillage,
    "Torturer": Torturer,
    "Patrol": Patrol,
    "Bridge": Bridge,
    "Nobles": Nobles,
    "Wishing Well": WishingWell,
    "Conspirator": Conspirator,
    "Ironworks": Ironworks,
    "Pawn": Pawn,
    "Bazaar": Bazaar,
    "Trading Post": TradingPost,
    "Trading post": TradingPost,
    "Wharf": Wharf,
    "Native Village": NativeVillage,
    "Native village": NativeVillage,
    "Lookout": Lookout,
    "First Mate": FirstMate,
    "Barbarian": Barbarian,
    "Flagship": Flagship,
    "Trickster": Trickster,
    "Highwayman": Highwayman,
    "Ironmonger": Ironmonger,
    "Marauder": Marauder,
    "Spoils": Spoils,
    "Ruins": Ruins,
    "Giant": Giant,
    "Artificer": Artificer,
    "Messenger": Messenger,
    "Tragic Hero": TragicHero,
    "Horse": Horse,
    "Destrier": Destrier,
    "Mastermind": Mastermind,
    "Paddock": Paddock,
}


def get_card(name: str) -> Card:
    """Get a new instance of a card by name."""
    if name not in CARD_TYPES:
        raise ValueError(f"Unknown card: {name}")
    return CARD_TYPES[name]()
