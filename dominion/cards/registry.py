from typing import Type

from dominion.cards.base_card import Card
from dominion.cards.base_set import (
    Chapel,
    CouncilRoom,
    Festival,
    Gardens,
    Laboratory,
    Library,
    Market,
    Mine,
    Moat,
    Smithy,
    Village,
    Witch,
    Workshop,
)
from dominion.cards.expansions import (
    Archive,
    Beggar,
    BustlingVillage,
    Capital,
    Castle,
    Catapult,
    Charm,
    ChariotRace,
    Crown,
    Collection,
    Emporium,
    Encampment,
    Engineer,
    FarmersMarket,
    Forager,
    Avanto,
    BlackMarket,
    Captain,
    Church,
    Forum,
    Fortune,
    Gladiator,
    Groundskeeper,
    Legionary,
    Dismantle,
    Envoy,
    Governor,
    Guardian,
    Miser,
    Modify,
    Prince,
    Overlord,
    Sauna,
    Patrician,
    Plunder,
    Rats,
    Rebuild,
    Rocks,
    Stash,
    RoyalBlacksmith,
    SnowyVillage,
    WalledVillage,
    Sacrifice,
    Settlers,
    Skulk,
    Temple,
    Villa,
    WildHunt,
    Crypt,
    Hovel,
    Necropolis,
    OvergrownEstate,
    Bank,
    Bishop,
    City,
    CityQuarter,
    Contraband,
    CountingHouse,
    Expand,
    Forge,
    Goons,
    GrandMarket,
    Hoard,
    KingsCourt,
    Loan,
    Mint,
    Monument,
    Mountebank,
    Peddler,
    Quarry,
    Rabble,
    RoyalSeal,
    Talisman,
    TradeRoute,
    Vault,
    Venture,
    Watchtower,
    WorkersVillage,
    Platinum,
    Colony,
    Amphora,
    Doubloons,
    EndlessChalice,
    Figurehead,
    Hammer,
    Insignia,
    Jewels,
    Orb,
    PrizeGoat,
    PuzzleBox,
    Sextant,
    Shield,
    SpellScroll,
    Staff,
    Sword,
    LOOT_CARD_NAMES,
)
from dominion.cards.hinterlands import (
    Berserker,
    BorderVillage,
    Cache,
    Cartographer,
    Cauldron,
    Crossroads,
    Develop,
    Duchess,
    Embassy,
    Farmland,
    FoolsGold,
    GuardDog,
    Haggler,
    Highway,
    IllGottenGains,
    Inn,
    JackOfAllTrades,
    Mandarin,
    Margrave,
    Mill,
    NobleBrigand,
    NomadCamp,
    Nomads,
    Oasis,
    Oracle,
    Scheme,
    SilkRoad,
    Souk,
    SpiceMerchant,
    Stables,
    Trader,
    Trail,
    Tunnel,
    Weaver,
    Wheelwright,
    WitchsHut,
)
from dominion.cards.renaissance import ActingTroupe, Inventor
from dominion.cards.allies import Taskmaster, WealthyVillage
from dominion.cards.intrigue import (
    Torturer,
    Patrol,
    Bridge,
    Nobles,
    WishingWell,
    Conspirator,
    Ironworks,
    Pawn,
)
from dominion.cards.plunder import Barbarian, FirstMate, Flagship, Highwayman, Trickster
from dominion.cards.dark_ages import Armory, Count, Ironmonger, Marauder, PoorHouse, Spoils, Ruins
from dominion.cards.seaside import Bazaar, Lookout, NativeVillage, TradingPost, Wharf
from dominion.cards.adventures import Artificer, Giant
from dominion.cards.nocturne import TragicHero
from dominion.cards.menagerie import Destrier, Horse, Mastermind, Paddock

from dominion.cards.treasures import Copper, Gold, Silver
from dominion.cards.victory import Curse, Duchy, Estate, Province

# Updated registry of all card types
CARD_TYPES: dict[str, Type[Card]] = {
    # Treasure cards
    "Copper": Copper,
    "Silver": Silver,
    "Gold": Gold,
    # Victory cards
    "Estate": Estate,
    "Duchy": Duchy,
    "Province": Province,
    "Curse": Curse,
    "Gardens": Gardens,
    # Action cards
    "Village": Village,
    "Smithy": Smithy,
    "Market": Market,
    "Festival": Festival,
    "Laboratory": Laboratory,
    "Mine": Mine,
    "Witch": Witch,
    "Moat": Moat,
    "Workshop": Workshop,
    "Chapel": Chapel,
    "Council Room": CouncilRoom,
    "Council room": CouncilRoom,
    "Library": Library,
    # Expansion cards
    "Archive": Archive,
    "Bustling Village": BustlingVillage,
    "Capital": Capital,
    "Castle": Castle,
    "Catapult": Catapult,
    "Charm": Charm,
    "Chariot Race": ChariotRace,
    "Patrician": Patrician,
    "Emporium": Emporium,
    "Forager": Forager,
    "Avanto": Avanto,
    "Black Market": BlackMarket,
    "Captain": Captain,
    "Church": Church,
    "Dismantle": Dismantle,
    "Envoy": Envoy,
    "Governor": Governor,
    "Guardian": Guardian,
    "Prince": Prince,
    "Sauna": Sauna,
    "Snowy Village": SnowyVillage,
    "Stash": Stash,
    "Walled Village": WalledVillage,
    "Miser": Miser,
    "Rats": Rats,
    "Skulk": Skulk,
    "Collection": Collection,
    "Beggar": Beggar,
    "Poor House": PoorHouse,
    "Poor house": PoorHouse,
    "Modify": Modify,
    "Rebuild": Rebuild,
    "Count": Count,
    "Armory": Armory,
    "Crypt": Crypt,
    "Hovel": Hovel,
    "Necropolis": Necropolis,
    "Overgrown Estate": OvergrownEstate,
    "Crown": Crown,
    "Encampment": Encampment,
    "Engineer": Engineer,
    "Farmers' Market": FarmersMarket,
    "Forum": Forum,
    "Fortune": Fortune,
    "Gladiator": Gladiator,
    "Bank": Bank,
    "Bishop": Bishop,
    "City": City,
    "City Quarter": CityQuarter,
    "City quarter": CityQuarter,
    "Contraband": Contraband,
    "Counting House": CountingHouse,
    "Expand": Expand,
    "Forge": Forge,
    "Goons": Goons,
    "Grand Market": GrandMarket,
    "Hoard": Hoard,
    "King's Court": KingsCourt,
    "Loan": Loan,
    "Mint": Mint,
    "Monument": Monument,
    "Mountebank": Mountebank,
    "Overlord": Overlord,
    "Peddler": Peddler,
    "Quarry": Quarry,
    "Rabble": Rabble,
    "Rocks": Rocks,
    "Royal Seal": RoyalSeal,
    "Royal Blacksmith": RoyalBlacksmith,
    "Sacrifice": Sacrifice,
    "Settlers": Settlers,
    "Talisman": Talisman,
    "Temple": Temple,
    "Trade Route": TradeRoute,
    "Vault": Vault,
    "Venture": Venture,
    "Watchtower": Watchtower,
    "Workers' Village": WorkersVillage,
    "Villa": Villa,
    "Wild Hunt": WildHunt,
    "Legionary": Legionary,
    "Groundskeeper": Groundskeeper,
    "Plunder": Plunder,
    "Platinum": Platinum,
    "Colony": Colony,
    "Amphora": Amphora,
    "Doubloons": Doubloons,
    "Endless Chalice": EndlessChalice,
    "Figurehead": Figurehead,
    "Hammer": Hammer,
    "Insignia": Insignia,
    "Jewels": Jewels,
    "Orb": Orb,
    "Prize Goat": PrizeGoat,
    "Puzzle Box": PuzzleBox,
    "Sextant": Sextant,
    "Shield": Shield,
    "Spell Scroll": SpellScroll,
    "Staff": Staff,
    "Sword": Sword,
    "Berserker": Berserker,
    "Border Village": BorderVillage,
    "Cache": Cache,
    "Cartographer": Cartographer,
    "Cauldron": Cauldron,
    "Crossroads": Crossroads,
    "Develop": Develop,
    "Duchess": Duchess,
    "Embassy": Embassy,
    "Farmland": Farmland,
    "Fool's Gold": FoolsGold,
    "Guard Dog": GuardDog,
    "Haggler": Haggler,
    "Highway": Highway,
    "Ill-Gotten Gains": IllGottenGains,
    "Inn": Inn,
    "Jack of All Trades": JackOfAllTrades,
    "Mandarin": Mandarin,
    "Margrave": Margrave,
    "Mill": Mill,
    "Noble Brigand": NobleBrigand,
    "Nomad Camp": NomadCamp,
    "Nomads": Nomads,
    "Oasis": Oasis,
    "Oracle": Oracle,
    "Scheme": Scheme,
    "Silk Road": SilkRoad,
    "Souk": Souk,
    "Spice Merchant": SpiceMerchant,
    "Stables": Stables,
    "Trader": Trader,
    "Trail": Trail,
    "Tunnel": Tunnel,
    "Weaver": Weaver,
    "Wheelwright": Wheelwright,
    "Witch's Hut": WitchsHut,
    "Acting Troupe": ActingTroupe,
    "Inventor": Inventor,
    "Taskmaster": Taskmaster,
    "Wealthy Village": WealthyVillage,
    "Wealthy village": WealthyVillage,
    "Torturer": Torturer,
    "Patrol": Patrol,
    "Bridge": Bridge,
    "Nobles": Nobles,
    "Wishing Well": WishingWell,
    "Conspirator": Conspirator,
    "Ironworks": Ironworks,
    "Pawn": Pawn,
    "Bazaar": Bazaar,
    "Trading Post": TradingPost,
    "Trading post": TradingPost,
    "Wharf": Wharf,
    "Native Village": NativeVillage,
    "Native village": NativeVillage,
    "Lookout": Lookout,
    "First Mate": FirstMate,
    "Barbarian": Barbarian,
    "Flagship": Flagship,
    "Trickster": Trickster,
    "Highwayman": Highwayman,
    "Ironmonger": Ironmonger,
    "Marauder": Marauder,
    "Spoils": Spoils,
    "Ruins": Ruins,
    "Giant": Giant,
    "Artificer": Artificer,
    "Tragic Hero": TragicHero,
    "Horse": Horse,
    "Destrier": Destrier,
    "Mastermind": Mastermind,
    "Paddock": Paddock,
}


def get_card(name: str) -> Card:
    """Get a new instance of a card by name."""
    if name not in CARD_TYPES:
        raise ValueError(f"Unknown card: {name}")
    return CARD_TYPES[name]()
